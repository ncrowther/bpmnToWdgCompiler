defVar --name result --type Boolean --value True

goSub --label GetTicketsFromInbox

beginSub --name NotifyCustomer
logMessage --message NotifyCustomer --type "Info"
goSub --label GetNextTicket

endSub

beginSub --name OpenBarclaycard
logMessage --message OpenBarclaycard --type "Info"
goSub --label EnterTicketNumber

endSub

beginSub --name GetTicketNumber
logMessage --message GetTicketNumber --type "Info"
goSub --label EnterTicketNumberIntoSmart

endSub

beginSub --name GetTicketsFromInbox
logMessage --message GetTicketsFromInbox --type "Info"
goSub --label OpenTicketsInExcel

endSub

beginSub --name ViewTicketAndRequeue
logMessage --message ViewTicketAndRequeue --type "Info"
goSub --label NotifyCustomer

endSub

beginSub --name BarlaycardAcceptPayment
logMessage --message BarlaycardAcceptPayment --type "Info"
goSub --label ViewTicketAndRequeue

endSub

beginSub --name EnterTicketNumber
logMessage --message EnterTicketNumber --type "Info"
goSub --label CancelPendingPayment

endSub

beginSub --name EnterTicketNumberIntoSmart
logMessage --message EnterTicketNumberIntoSmart --type "Info"
if --left "${result}" --operator "Is_True"
// Success path 
goSub --label BarlaycardAcceptPayment
else
// Failure path 
goSub --label OpenBarclaycard
endif

endSub

beginSub --name OpenTicketsInExcel
logMessage --message OpenTicketsInExcel --type "Info"
goSub --label GetNextTicket

endSub

beginSub --name GetNextTicket
logMessage --message GetNextTicket --type "Info"
if --left "${result}" --operator "Is_True"
// Success path 
goSub --label GetTicketNumber
endif

endSub

beginSub --name CancelPendingPayment
logMessage --message CancelPendingPayment --type "Info"
goSub --label GetNextTicket

endSub
